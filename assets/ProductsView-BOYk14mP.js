import{a as _,S as i}from"./sweetalert2.all-BG_37rGc.js";import{o as d,c as l,a as e,h as x,m as $,F as k,g as w,t as v,p as B,q as I,l as N,r as b,f as R,b as A,s as D,i as M}from"./index-BkDzF00W.js";import{_ as z}from"./ProductModal-rOLQixGk.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const y=h=>(B("data-v-9ee297f3"),h=h(),I(),h),O={class:"container mx-a py-6"},U={class:"flex justify-center"},F={class:"flex items-center text-#0d6efd"},H=y(()=>e("div",{class:"i-mdi:arrow-left"},null,-1)),J=[H],j=["onClick"],q=y(()=>e("div",{class:"i-mdi:arrow-right"},null,-1)),W=[q],G={__name:"PaginationComponent",props:["pages"],emits:["changePage"],setup(h,{emit:u}){const r=h,m=u;function p(c){m("changePage",c)}return(c,n)=>(d(),l("div",O,[e("nav",U,[e("ul",F,[e("li",{class:x(["border-solid border-#dee2e6 border-1 border-collapse rd-tl rd-bl",{disabled:r.pages.current_page===1}])},[e("a",{href:"#",class:"block p-2 text-#0d6efd hover:bg-#e9ecef hover:cursor-pointer",onClick:n[0]||(n[0]=$(a=>p(r.pages.current_page-1),["prevent"]))},J)],2),(d(!0),l(k,null,w(r.pages.total_pages,a=>(d(),l("li",{key:a,class:x(["border-solid border-#dee2e6 border-1 border-collapse",{active:a===r.pages.current_page}])},[e("a",{href:"#",class:"font-size-4 decoration-none block text-#0d6efd px-3 py-1 hover:bg-#e9ecef hover:cursor-pointer",onClick:$(f=>p(a),["prevent"])},v(a),9,j)],2))),128)),e("li",{class:x(["border-solid border-#dee2e6 border-1 border-collapse rd-tr rd-br",{disabled:r.pages.current_page===r.pages.total_pages}])},[e("a",{href:"#",class:"block p-2 text-#0d6efd hover:bg-#e9ecef hover:cursor-pointer",onClick:n[1]||(n[1]=$(a=>p(r.pages.current_page+1),["prevent"]))},W)],2)])])]))}},K=L(G,[["__scopeId","data-v-9ee297f3"]]);var Q={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/vue2023-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const X={class:"container mx-a"},Y={class:"text-end mt-6"},Z={class:"w-100% mt-6"},ee=e("thead",{class:"border-b-1 border-black border-solid fw-bold text-left"},[e("tr",null,[e("th",{width:"120"}," 分類 "),e("th",null,"產品名稱"),e("th",{width:"120",class:"text-end"}," 原價 "),e("th",{width:"120",class:"text-end"}," 售價 "),e("th",{width:"100",class:"text-center"}," 是否啟用 "),e("th",{width:"120"}," 編輯 ")])],-1),te={class:"text-end"},oe={class:"text-end"},se={class:"text-center"},re={key:0,class:"text-#198754"},ae={key:1,class:"text-red"},ne={class:"btn-group"},ie=["onClick"],de=["onClick"],he={__name:"ProductsView",setup(h){const{VITE_URL:u,VITE_PATH:r}=Q,m=N(),p=b([]),c=b(),n=b({}),a=b(!0),f=b({});function C(){var o;const s=(o=document.cookie.split("; ").find(t=>t.startsWith("myToken=")))==null?void 0:o.split("=")[1];s&&(_.defaults.headers.common.Authorization=s),_.post(`${u}/v2/api/user/check`).then(()=>{g()}).catch(()=>{i.fire({title:"請先登入",icon:"error",didClose:()=>{m.push("/")}})})}function g(s=1){_.get(`${u}/v2/api/${r}/admin/products?page=${s}`).then(o=>{p.value=o.data.products,f.value=o.data.pagination})}function P(){c.value.dialog.showModal(),n.value={},a.value=!0}function E(s){n.value=JSON.parse(JSON.stringify(s)),a.value=!1,c.value.dialog.showModal()}function S(s){if(a.value)_.post(`${u}/v2/api/${r}/admin/product`,{data:s}).then(o=>{i.fire({title:`${o.data.message}`,icon:"success"}),c.value.dialog.close(),n.value={},g(f.value.current_page||1)}).catch(o=>{i.fire({icon:"error",target:"dialog",title:"錯誤發生",text:`${o}`})});else{const{id:o}=s;_.put(`${u}/v2/api/${r}/admin/product/${o}`,{data:s}).then(t=>{i.fire({title:`${t.data.message}`,icon:"success"}),c.value.dialog.close(),n.value={},g(f.value.current_page||1)}).catch(t=>{i.fire({icon:"error",target:"dialog",title:"錯誤發生",text:`${t.response.data.message}`})})}}function T(s){i.fire({title:`你確定要刪除 ${s.title} 嗎?`,showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then(o=>{o.isConfirmed&&_.delete(`${u}/v2/api/${r}/admin/product/${s.id}`).then(t=>{g(),i.fire(t.data.message),i.fire({icon:"success",text:t.data.message})}).catch(t=>{i.fire({icon:"error",text:t.response.data.message})})})}return R(()=>{C()}),(s,o)=>(d(),l(k,null,[e("div",X,[e("div",Y,[e("button",{type:"button",class:"bg-#0d6efd border-0 text-white cursor-pointer inline-block px-3 py-1.5 rd font-size-4 hover:bg-#0b5ed7",onClick:o[0]||(o[0]=t=>P())},"建立新的產品")]),e("table",Z,[ee,e("tbody",null,[(d(!0),l(k,null,w(p.value,t=>(d(),l("tr",{class:"border-b border-#DEE2E6 border-solid",key:t.id},[e("td",null,v(t.category),1),e("td",null,v(t.title),1),e("td",te,v(t.origin_price),1),e("td",oe,v(t.price),1),e("td",se,[t.is_enabled?(d(),l("span",re,"啟用")):(d(),l("span",ae,"未啟用"))]),e("td",null,[e("div",ne,[e("button",{type:"button",class:"text-#0d6efd bg-transparent border-1 border-#0d6efd border-solid border-r-0 rd-tl rd-bl px-2 py-1 hover:bg-#0d6efd hover:text-white hover:cursor-pointer",onClick:V=>E(t)}," 編輯 ",8,ie),e("button",{type:"button",class:"text-#dc3545 bg-transparent border-1 border-#de3545 border-solid rd-tr rd-br px-2 py-1 hover:bg-#de3545 hover:text-white hover:cursor-pointer",onClick:V=>T(t)}," 刪除 ",8,de)])])]))),128))])])]),A(z,{onConfirmProduct:S,"temp-product":n.value,"is-new":a.value,ref_key:"dialog",ref:c},null,8,["temp-product","is-new"]),p.value.length?(d(),D(K,{key:0,pages:f.value,onChangePage:g},null,8,["pages"])):M("",!0)],64))}};export{he as default};
